# ============================================
# Security Headers Configuration for nginx
# ============================================
# Add these headers to your nginx server block
# This fixes ~70% of HIGH/MEDIUM security findings
# ============================================

server {
    # ... your existing server config ...

    # Content Security Policy (HIGH priority)
    # Adjust policy based on your app's needs
    add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https:; frame-ancestors 'self';" always;

    # HTTP Strict Transport Security (HIGH priority)
    # Forces HTTPS for 1 year, includes subdomains
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

    # X-Frame-Options (HIGH priority)
    # Prevents clickjacking attacks
    add_header X-Frame-Options "SAMEORIGIN" always;

    # X-Content-Type-Options (MEDIUM priority)
    # Prevents MIME type sniffing
    add_header X-Content-Type-Options "nosniff" always;

    # X-XSS-Protection (MEDIUM priority)
    # Legacy browser XSS protection
    add_header X-XSS-Protection "1; mode=block" always;

    # Referrer-Policy (MEDIUM priority)
    # Controls referrer information
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;

    # Permissions-Policy (LOW priority)
    # Controls browser features
    add_header Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()" always;

    # Hide server information (LOW priority)
    server_tokens off;

    # ... rest of your server config ...
}

# ============================================
# Quick Setup Instructions:
# ============================================
# 1. Copy the add_header lines above
# 2. Add them to your nginx server block
# 3. Test: nginx -t
# 4. Reload: nginx -s reload
# 5. Re-scan your sites
# ============================================

